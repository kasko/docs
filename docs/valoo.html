<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>KASKO</title>
</head>

<body>
  <script type="text/javascript" src="https://js.kasko.io"></script>
  <div id="kasko-widget-container"></div>
  <script>
    var callback = Kasko.getUrlParameter('callback_url');
    var unique_identifier = Kasko.getUrlParameter('unique_identifier');
    var language = Kasko.getUrlParameter('language');
    var purchase_date = Kasko.getUrlParameter('purchase_date');
    var purchase_value = Kasko.getUrlParameter('purchase_value');
    var product_model = Kasko.getUrlParameter('product_model');

    var tags = Kasko.getUrlParameter('item');
    try {
      tags = JSON.parse(tags);
    } catch (e) {}

    Kasko.Setup({
      container: 'kasko-widget-container',
      key: 'pk_test_pGNQ5gr7DPmdeYy2oROx90j61bXZM3av',
      touchpoint: 'tp_a3c1706de17ad38563ab9aa9b070c',
      mode: 'fullscreen',
      language: language,
      config: {
        back_button_url: 'https://google.com',
        item_id: 'item_b3e70c9590d7e1f0d9514c5164f',
      },
      tags: tags,
      metadata: {
        unique_identifier: unique_identifier,
      },
      data: {
        item_purchase_date: purchase_date,
        item_value: purchase_value,
        item_description: product_model,
      },  
      onSuccess: function(data) {
        var URL = callback;
        var POLICY_ID = data.policy.id;
        var UNIQUE_IDENTIFIER = unique_identifier;
        var DELAY = 3000;

        setTimeout(function() {
          window.location.href = URL + '?' + 'policy_id=' + POLICY_ID + '&' + 'unique_identifier=' + UNIQUE_IDENTIFIER;
        }, DELAY);
      },
    });
  </script>
</body>

</html>
